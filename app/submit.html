<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Submit Matchup - Scrumble</title>
    <!-- SEO: page meta bundle -->
    <link rel="canonical" href="https://scrumble.cc/submit.html" />
    <meta name="description" content="Submit a Chattanooga matchup for Scrumble. Suggest local food, coffee, drinks, and neighborhood face-offs." />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Submit Matchup - Scrumble" />
    <meta property="og:description" content="Submit a Chattanooga matchup for Scrumble. Suggest local food, coffee, drinks, and neighborhood face-offs." />
    <meta property="og:url" content="https://scrumble.cc/submit.html" />
    <meta property="og:site_name" content="Scrumble" />
    <meta property="og:image" content="https://scrumble.cc/public/white_duck_logo.png" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Submit Matchup - Scrumble" />
    <meta name="twitter:description" content="Submit a Chattanooga matchup for Scrumble. Suggest local food, coffee, drinks, and neighborhood face-offs." />
    <meta name="twitter:image" content="https://scrumble.cc/public/white_duck_logo.png" />
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebPage",
      "name": "Submit Matchup - Scrumble",
      "description": "Submit a Chattanooga matchup for Scrumble. Suggest local food, coffee, drinks, and neighborhood face-offs.",
      "url": "https://scrumble.cc/submit.html",
      "isPartOf": { "@type": "WebSite", "name": "Scrumble", "url": "https://scrumble.cc/" }
    }
    </script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Fraunces:wght@600;700&family=Space+Grotesk:wght@400;500;600&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <nav class="navbar">
      <a href="/" class="navbar-brand" style="text-decoration: none; color: inherit;">SCRUMBLE</a>
      <button class="navbar-toggle" aria-label="Toggle menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
      <ul class="navbar-menu">
        <li><a href="index.html#arena">Vote</a></li>
        <li><a href="submit.html">Submit</a></li>
        <li><a href="history.html">History</a></li>
        <li><a href="partner.html">Partner</a></li>
        <li><a href="about.html">About</a></li>
        <li><a href="jobs.html">Jobs</a></li>
        <li><button class="theme-toggle" type="button" aria-label="Cycle theme">Theme</button></li>
      </ul>
    </nav>
    <div class="page">
      <header class="hero">
        <h1 class="hero-title" style="font-size: 3rem; margin-bottom: 20px;">
          <span>SUBMIT A MATCHUP</span>
        </h1>
        <p style="max-width: 600px; margin: 0 auto 40px; color: var(--muted);">
          Suggest two local spots that should go head-to-head. We review submissions quickly (target: within 72 hours) and publish the strongest matchups.
        </p>
      </header>

      <main>
        <section class="arena" style="max-width: 700px; margin: 0 auto;">
          <form id="submit-form">
            <div style="display: grid; gap: 20px;">
              <div>
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--accent);">Entry 1 Name *</label>
                <input type="text" id="left-name" required placeholder="e.g. Tremont Tavern" style="width: 100%; padding: 12px; border-radius: 12px; border: 1px solid var(--line); background: var(--bg); color: var(--ink); font-family: inherit; font-size: 1rem;">
              </div>

              <div>
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--accent);">Entry 2 Name *</label>
                <input type="text" id="right-name" required placeholder="e.g. Main St Meats" style="width: 100%; padding: 12px; border-radius: 12px; border: 1px solid var(--line); background: var(--bg); color: var(--ink); font-family: inherit; font-size: 1rem;">
              </div>

              <div>
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--accent);">Category *</label>
                <select id="category" required style="width: 100%; padding: 12px; border-radius: 12px; border: 1px solid var(--line); background: var(--bg); color: var(--ink); font-family: inherit; font-size: 1rem;">
                  <option value="">Select category</option>
                  <option value="food">Food</option>
                  <option value="coffee">Coffee</option>
                  <option value="drinks">Drinks</option>
                  <option value="outdoors">Outdoors</option>
                  <option value="other">Other</option>
                </select>
              </div>

              <div>
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--muted);">Your Email (optional)</label>
                <input type="email" id="email" placeholder="your@email.com" style="width: 100%; padding: 12px; border-radius: 12px; border: 1px solid var(--line); background: var(--bg); color: var(--ink); font-family: inherit; font-size: 1rem;">
              </div>

              <div>
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--muted);">Why this matchup?</label>
                <textarea id="reason" rows="3" placeholder="Tell us why these two should face off..." style="width: 100%; padding: 12px; border-radius: 12px; border: 1px solid var(--line); background: var(--bg); color: var(--ink); font-family: inherit; font-size: 1rem; resize: vertical;"></textarea>
              </div>

              <div style="display: flex; gap: 12px; margin-top: 10px;">
                <button type="submit" class="btn primary" style="flex: 1;">Submit Matchup</button>
                <a href="index.html" class="btn ghost" style="flex: 1; text-align: center; line-height: 2.2;">Cancel</a>
              </div>

              <div id="status" style="text-align: center; font-size: 0.9rem;" aria-live="polite"></div>
            </div>
          </form>
          <div id="submit-confirmation" class="submit-confirmation" hidden>
            <div class="submit-confirmation-icon">✓</div>
            <h2>Submission received</h2>
            <p>Thanks for the tip. We'll review it and add the best matchups.</p>
            <div class="submit-confirmation-details">
              <div class="submit-confirmation-row">
                <span>Entry 1</span>
                <strong id="confirm-left"></strong>
              </div>
              <div class="submit-confirmation-row">
                <span>Entry 2</span>
                <strong id="confirm-right"></strong>
              </div>
              <div class="submit-confirmation-row">
                <span>Category</span>
                <strong id="confirm-category"></strong>
              </div>
            </div>
            <div class="submit-confirmation-actions">
              <button type="button" id="submit-another" class="btn ghost">Submit Another</button>
              <a href="index.html" class="btn primary" style="text-align: center; line-height: 2.2;">Back to Vote</a>
            </div>
          </div>
        </section>
      </main>
    </div>

    <script src="config.js"></script>
    <script src="visit.js"></script>
    <script src="theme.js"></script>
    <script>
      const API_BASE = (window.SCRUMBLE_API_BASE || "").trim();
      const API_URL = API_BASE.endsWith("/") ? API_BASE.slice(0, -1) : API_BASE;

      const form = document.getElementById('submit-form');
      const status = document.getElementById('status');

      const ANALYTICS_DEBUG = window.SCRUMBLE_ANALYTICS_DEBUG === true;

      function trackEvent(name, params = {}) {
        try {
          if (ANALYTICS_DEBUG) console.info('[analytics]', name, params);
          if (typeof window.gtag === 'function') window.gtag('event', name, params);
          if (typeof window.plausible === 'function') window.plausible(name, { props: params });
        } catch (err) {
          console.debug('trackEvent failed', name, err);
        }
      }
      const confirmation = document.getElementById('submit-confirmation');
      const confirmLeft = document.getElementById('confirm-left');
      const confirmRight = document.getElementById('confirm-right');
      const confirmCategory = document.getElementById('confirm-category');
      const submitAnother = document.getElementById('submit-another');

      function showConfirmation(data) {
        confirmLeft.textContent = data.left_name;
        confirmRight.textContent = data.right_name;
        confirmCategory.textContent = data.category_label;
        form.hidden = true;
        confirmation.hidden = false;
        confirmation.classList.add('show');
      }

      function resetConfirmation() {
        confirmation.hidden = true;
        confirmation.classList.remove('show');
        form.hidden = false;
        status.textContent = '';
      }

      submitAnother.addEventListener('click', () => {
        resetConfirmation();
        form.reset();
        document.getElementById('left-name').focus();
      });

      form.addEventListener('submit', async (e) => {
        e.preventDefault();

        const btn = e.target.querySelector('button[type="submit"]');
        const categorySelect = document.getElementById('category');
        const payload = {
          left_name: document.getElementById('left-name').value.trim(),
          right_name: document.getElementById('right-name').value.trim(),
          category: categorySelect.value,
          category_label: categorySelect.options[categorySelect.selectedIndex]?.text || categorySelect.value,
          email: document.getElementById('email').value.trim(),
          reason: document.getElementById('reason').value.trim()
        };

        btn.disabled = true;
        btn.textContent = 'Submitting...';
        status.textContent = '';

        try {
          const resp = await fetch(`${API_URL}/submit`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
              left_name: payload.left_name,
              right_name: payload.right_name,
              category: payload.category,
              email: payload.email,
              reason: payload.reason
            })
          });

          if (!resp.ok) throw new Error('Submission failed');

          status.style.color = 'var(--accent)';
          status.textContent = '✓ Submitted! We\'ll review it soon.';
          trackEvent('submit_success', { category: payload.category || 'unknown' });
          e.target.reset();
          showConfirmation(payload);
        } catch (err) {
          status.style.color = 'var(--accent)';
          status.textContent = 'Error: ' + err.message;
        } finally {
          btn.disabled = false;
          btn.textContent = 'Submit Matchup';
        }
      });
      
      const navToggle = document.querySelector('.navbar-toggle');
      const navMenu = document.querySelector('.navbar-menu');
      
      if (navToggle && navMenu) {
        navToggle.addEventListener('click', () => {
          navToggle.classList.toggle('active');
          navMenu.classList.toggle('active');
        });
        
        navMenu.querySelectorAll('a').forEach(link => {
          link.addEventListener('click', () => {
            navToggle.classList.remove('active');
            navMenu.classList.remove('active');
          });
        });
      }
    </script>
  </body>
</html>
