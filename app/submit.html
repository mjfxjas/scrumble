<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Submit Matchup - Scrumble</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Fraunces:wght@600;700&family=Space+Grotesk:wght@400;500;600&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="page">
      <header class="hero">
        <h1 class="hero-title" style="font-size: 3rem; margin-bottom: 20px;">
          <span>SUBMIT A MATCHUP</span>
        </h1>
        <p style="max-width: 600px; margin: 0 auto 40px; color: var(--muted);">
          Suggest two local spots that should go head-to-head. We'll review and add the best ones.
        </p>
      </header>

      <main>
        <section class="arena" style="max-width: 700px; margin: 0 auto;">
          <form id="submit-form">
            <div style="display: grid; gap: 20px;">
              <div>
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--accent);">Entry 1 Name *</label>
                <input type="text" id="left-name" required placeholder="e.g. Tremont Tavern" style="width: 100%; padding: 12px; border-radius: 12px; border: 1px solid var(--line); background: var(--bg); color: var(--ink); font-family: inherit; font-size: 1rem;">
              </div>

              <div>
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--accent);">Entry 2 Name *</label>
                <input type="text" id="right-name" required placeholder="e.g. Main St Meats" style="width: 100%; padding: 12px; border-radius: 12px; border: 1px solid var(--line); background: var(--bg); color: var(--ink); font-family: inherit; font-size: 1rem;">
              </div>

              <div>
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--accent);">Category *</label>
                <select id="category" required style="width: 100%; padding: 12px; border-radius: 12px; border: 1px solid var(--line); background: var(--bg); color: var(--ink); font-family: inherit; font-size: 1rem;">
                  <option value="">Select category</option>
                  <option value="food">Food</option>
                  <option value="coffee">Coffee</option>
                  <option value="drinks">Drinks</option>
                  <option value="outdoors">Outdoors</option>
                  <option value="other">Other</option>
                </select>
              </div>

              <div>
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--muted);">Your Email (optional)</label>
                <input type="email" id="email" placeholder="your@email.com" style="width: 100%; padding: 12px; border-radius: 12px; border: 1px solid var(--line); background: var(--bg); color: var(--ink); font-family: inherit; font-size: 1rem;">
              </div>

              <div>
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--muted);">Why this matchup?</label>
                <textarea id="reason" rows="3" placeholder="Tell us why these two should face off..." style="width: 100%; padding: 12px; border-radius: 12px; border: 1px solid var(--line); background: var(--bg); color: var(--ink); font-family: inherit; font-size: 1rem; resize: vertical;"></textarea>
              </div>

              <div style="display: flex; gap: 12px; margin-top: 10px;">
                <button type="submit" class="btn primary" style="flex: 1;">Submit Matchup</button>
                <a href="index.html" class="btn ghost" style="flex: 1; text-align: center; line-height: 2.2;">Cancel</a>
              </div>

              <div id="status" style="text-align: center; font-size: 0.9rem;"></div>
            </div>
          </form>
        </section>
      </main>
    </div>

    <script src="config.js"></script>
    <script>
      const API_BASE = (window.SCRUMBLE_API_BASE || "").trim();
      const API_URL = API_BASE.endsWith("/") ? API_BASE.slice(0, -1) : API_BASE;

      document.getElementById('submit-form').addEventListener('submit', async (e) => {
        e.preventDefault();
        
        const status = document.getElementById('status');
        const btn = e.target.querySelector('button[type="submit"]');
        
        btn.disabled = true;
        btn.textContent = 'Submitting...';
        status.textContent = '';
        
        try {
          const resp = await fetch(`${API_URL}/submit`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
              left_name: document.getElementById('left-name').value,
              right_name: document.getElementById('right-name').value,
              category: document.getElementById('category').value,
              email: document.getElementById('email').value,
              reason: document.getElementById('reason').value
            })
          });
          
          if (!resp.ok) throw new Error('Submission failed');
          
          status.style.color = 'var(--accent)';
          status.textContent = 'âœ“ Submitted! We'll review it soon.';
          e.target.reset();
          
          setTimeout(() => {
            window.location.href = 'index.html';
          }, 2000);
        } catch (err) {
          status.style.color = 'var(--accent)';
          status.textContent = 'Error: ' + err.message;
        } finally {
          btn.disabled = false;
          btn.textContent = 'Submit Matchup';
        }
      });
    </script>
  </body>
</html>
